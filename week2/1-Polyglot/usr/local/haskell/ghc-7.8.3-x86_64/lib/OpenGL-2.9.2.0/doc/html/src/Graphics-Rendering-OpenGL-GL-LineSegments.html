<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>Graphics/Rendering/OpenGL/GL/LineSegments.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>--------------------------------------------------------------------------------</span>
<a name="line-2"></a><span class='hs-comment'>-- |</span>
<a name="line-3"></a><span class='hs-comment'>-- Module      :  Graphics.Rendering.OpenGL.GL.LineSegments</span>
<a name="line-4"></a><span class='hs-comment'>-- Copyright   :  (c) Sven Panne 2002-2013</span>
<a name="line-5"></a><span class='hs-comment'>-- License     :  BSD3</span>
<a name="line-6"></a><span class='hs-comment'>-- </span>
<a name="line-7"></a><span class='hs-comment'>-- Maintainer  :  Sven Panne &lt;svenpanne@gmail.com&gt;</span>
<a name="line-8"></a><span class='hs-comment'>-- Stability   :  stable</span>
<a name="line-9"></a><span class='hs-comment'>-- Portability :  portable</span>
<a name="line-10"></a><span class='hs-comment'>--</span>
<a name="line-11"></a><span class='hs-comment'>-- This module corresponds to section 3.4 (Line Segments) of the OpenGL 2.1</span>
<a name="line-12"></a><span class='hs-comment'>-- specs.</span>
<a name="line-13"></a><span class='hs-comment'>--</span>
<a name="line-14"></a><span class='hs-comment'>--------------------------------------------------------------------------------</span>
<a name="line-15"></a>
<a name="line-16"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Graphics</span><span class='hs-varop'>.</span><span class='hs-conid'>Rendering</span><span class='hs-varop'>.</span><span class='hs-conid'>OpenGL</span><span class='hs-varop'>.</span><span class='hs-conid'>GL</span><span class='hs-varop'>.</span><span class='hs-conid'>LineSegments</span> <span class='hs-layout'>(</span>
<a name="line-17"></a>   <span class='hs-comment'>-- * Line Rasterization</span>
<a name="line-18"></a>   <span class='hs-varid'>lineWidth</span><span class='hs-layout'>,</span>
<a name="line-19"></a>
<a name="line-20"></a>   <span class='hs-comment'>-- * Line Stipple</span>
<a name="line-21"></a>   <span class='hs-varid'>lineStipple</span><span class='hs-layout'>,</span>
<a name="line-22"></a>
<a name="line-23"></a>   <span class='hs-comment'>-- * Line Antialiasing</span>
<a name="line-24"></a>  <span class='hs-varid'>lineSmooth</span><span class='hs-layout'>,</span>
<a name="line-25"></a>
<a name="line-26"></a>   <span class='hs-comment'>-- * Implementation-Dependent Limits</span>
<a name="line-27"></a>   <span class='hs-varid'>aliasedLineWidthRange</span><span class='hs-layout'>,</span> <span class='hs-varid'>smoothLineWidthRange</span><span class='hs-layout'>,</span> <span class='hs-varid'>smoothLineWidthGranularity</span>
<a name="line-28"></a><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-29"></a>
<a name="line-30"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Control</span><span class='hs-varop'>.</span><span class='hs-conid'>Monad</span>
<a name="line-31"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Graphics</span><span class='hs-varop'>.</span><span class='hs-conid'>Rendering</span><span class='hs-varop'>.</span><span class='hs-conid'>OpenGL</span><span class='hs-varop'>.</span><span class='hs-conid'>GL</span><span class='hs-varop'>.</span><span class='hs-conid'>Capability</span>
<a name="line-32"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Graphics</span><span class='hs-varop'>.</span><span class='hs-conid'>Rendering</span><span class='hs-varop'>.</span><span class='hs-conid'>OpenGL</span><span class='hs-varop'>.</span><span class='hs-conid'>GL</span><span class='hs-varop'>.</span><span class='hs-conid'>QueryUtils</span>
<a name="line-33"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Graphics</span><span class='hs-varop'>.</span><span class='hs-conid'>Rendering</span><span class='hs-varop'>.</span><span class='hs-conid'>OpenGL</span><span class='hs-varop'>.</span><span class='hs-conid'>GL</span><span class='hs-varop'>.</span><span class='hs-conid'>StateVar</span>
<a name="line-34"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Graphics</span><span class='hs-varop'>.</span><span class='hs-conid'>Rendering</span><span class='hs-varop'>.</span><span class='hs-conid'>OpenGL</span><span class='hs-varop'>.</span><span class='hs-conid'>Raw</span>
<a name="line-35"></a>
<a name="line-36"></a><span class='hs-comment'>--------------------------------------------------------------------------------</span>
<a name="line-37"></a>
<a name="line-38"></a><span class='hs-comment'>-- | 'lineWidth' contains the rasterized width of both aliased and antialiased</span>
<a name="line-39"></a><span class='hs-comment'>-- lines. The initial value is 1. Using a line width other than 1 has different</span>
<a name="line-40"></a><span class='hs-comment'>-- effects, depending on whether line antialiasing is enabled (see</span>
<a name="line-41"></a><span class='hs-comment'>-- 'lineSmooth'). Line antialiasing is initially disabled.</span>
<a name="line-42"></a><span class='hs-comment'>--</span>
<a name="line-43"></a><span class='hs-comment'>-- If line antialiasing is disabled, the actual width is determined by rounding</span>
<a name="line-44"></a><span class='hs-comment'>-- the supplied width to the nearest integer. (If the rounding results in the</span>
<a name="line-45"></a><span class='hs-comment'>-- value 0, it is as if the line width were 1.) If /delta x/ &gt;= /delta y/, /i/</span>
<a name="line-46"></a><span class='hs-comment'>-- pixels are filled in each column that is rasterized, where /i/ is the</span>
<a name="line-47"></a><span class='hs-comment'>-- rounded value of 'lineWidth'. Otherwise, /i/ pixels are filled in each row</span>
<a name="line-48"></a><span class='hs-comment'>-- that is rasterized.</span>
<a name="line-49"></a><span class='hs-comment'>--</span>
<a name="line-50"></a><span class='hs-comment'>-- If antialiasing is enabled, line rasterization produces a fragment for each</span>
<a name="line-51"></a><span class='hs-comment'>-- pixel square that intersects the region lying within the rectangle having</span>
<a name="line-52"></a><span class='hs-comment'>-- width equal to the current line width, length equal to the actual length of</span>
<a name="line-53"></a><span class='hs-comment'>-- the line, and centered on the mathematical line segment. The coverage value</span>
<a name="line-54"></a><span class='hs-comment'>-- for each fragment is the window coordinate area of the intersection of the</span>
<a name="line-55"></a><span class='hs-comment'>-- rectangular region with the corresponding pixel square. This value is saved</span>
<a name="line-56"></a><span class='hs-comment'>-- and used in the final rasterization step.</span>
<a name="line-57"></a><span class='hs-comment'>--</span>
<a name="line-58"></a><span class='hs-comment'>-- Not all widths can be supported when line antialiasing is enabled. If an</span>
<a name="line-59"></a><span class='hs-comment'>-- unsupported width is requested, the nearest supported width is used. Only</span>
<a name="line-60"></a><span class='hs-comment'>-- width 1 is guaranteed to be supported; others depend on the implementation.</span>
<a name="line-61"></a><span class='hs-comment'>--  Likewise, there is a range for aliased line widths as well. To query the</span>
<a name="line-62"></a><span class='hs-comment'>-- range of supported widths of antialiased lines and the size difference</span>
<a name="line-63"></a><span class='hs-comment'>-- between supported widths within the range, query 'smoothLineWidthRange' and</span>
<a name="line-64"></a><span class='hs-comment'>-- 'smoothLineWidthGranularity', respectively. For aliased lines, query the</span>
<a name="line-65"></a><span class='hs-comment'>-- supported range with 'aliasedLineWidthRange'.</span>
<a name="line-66"></a><span class='hs-comment'>--</span>
<a name="line-67"></a><span class='hs-comment'>-- The line width specified when 'lineWidth' is set is always returned when it</span>
<a name="line-68"></a><span class='hs-comment'>-- is queried. Clamping and rounding for aliased and antialiased lines have no</span>
<a name="line-69"></a><span class='hs-comment'>-- effect on the specified value.</span>
<a name="line-70"></a><span class='hs-comment'>--</span>
<a name="line-71"></a><span class='hs-comment'>-- A non-antialiased line width may be clamped to an implementation-dependent</span>
<a name="line-72"></a><span class='hs-comment'>-- maximum.  Query 'aliasedLineWidthRange' to determine the maximum width.</span>
<a name="line-73"></a><span class='hs-comment'>--</span>
<a name="line-74"></a><span class='hs-comment'>-- An 'Graphics.Rendering.OpenGL.GLU.Errors.InvalidValue' is generated if</span>
<a name="line-75"></a><span class='hs-comment'>-- 'lineWidth' is set to a value less than or equal to zero.</span>
<a name="line-76"></a><span class='hs-comment'>--</span>
<a name="line-77"></a><span class='hs-comment'>-- An 'Graphics.Rendering.OpenGL.GLU.Errors.InvalidOperation' is generated if</span>
<a name="line-78"></a><span class='hs-comment'>-- 'lineWidth' is set during</span>
<a name="line-79"></a><span class='hs-comment'>-- 'Graphics.Rendering.OpenGL.GL.BeginEnd.renderPrimitive'.</span>
<a name="line-80"></a>
<a name="line-81"></a><a name="lineWidth"></a><span class='hs-definition'>lineWidth</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>GLfloat</span>
<a name="line-82"></a><span class='hs-definition'>lineWidth</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>makeStateVar</span> <span class='hs-layout'>(</span><span class='hs-varid'>getFloat1</span> <span class='hs-varid'>id</span> <span class='hs-conid'>GetLineWidth</span><span class='hs-layout'>)</span> <span class='hs-varid'>glLineWidth</span>
<a name="line-83"></a>
<a name="line-84"></a><span class='hs-comment'>--------------------------------------------------------------------------------</span>
<a name="line-85"></a>
<a name="line-86"></a><span class='hs-comment'>-- | Line stippling masks out certain fragments produced by rasterization; those</span>
<a name="line-87"></a><span class='hs-comment'>-- fragments will not be drawn. The masking is achieved by using three</span>
<a name="line-88"></a><span class='hs-comment'>-- parameters: the repeat count (1st element of the 'lineStipple' pair, clamped</span>
<a name="line-89"></a><span class='hs-comment'>-- to the range [ 1 .. 256 ]), the 16-bit line stipple pattern (2nd element),</span>
<a name="line-90"></a><span class='hs-comment'>-- and an integer stipple counter /s/.</span>
<a name="line-91"></a><span class='hs-comment'>--</span>
<a name="line-92"></a><span class='hs-comment'>-- The counter /s/ is reset to 0 at before the first action during</span>
<a name="line-93"></a><span class='hs-comment'>-- 'Graphics.Rendering.OpenGL.GL.BeginEnd.renderPrimitive' is called and before</span>
<a name="line-94"></a><span class='hs-comment'>-- each line segment during</span>
<a name="line-95"></a><span class='hs-comment'>-- 'Graphics.Rendering.OpenGL.GL.BeginEnd.renderPrimitive' is generated. It is</span>
<a name="line-96"></a><span class='hs-comment'>-- incremented after each fragment of a unit width aliased line segment is</span>
<a name="line-97"></a><span class='hs-comment'>-- generated or after each /i/ fragments of an /i/ width line segment are</span>
<a name="line-98"></a><span class='hs-comment'>-- generated. The /i/ fragments associated with count /s/ are masked out if</span>
<a name="line-99"></a><span class='hs-comment'>-- @'Data.Bits.testBit' /pattern/ (( /s/ \/ /factor/ ) /mod/ 16)@ is 'False',</span>
<a name="line-100"></a><span class='hs-comment'>-- otherwise these fragments are sent to the frame buffer. Bit zero of the</span>
<a name="line-101"></a><span class='hs-comment'>-- pattern is the least significant bit, i.e. it is used first.</span>
<a name="line-102"></a><span class='hs-comment'>--</span>
<a name="line-103"></a><span class='hs-comment'>-- Antialiased lines are treated as a sequence of rectangles of height 1 for</span>
<a name="line-104"></a><span class='hs-comment'>-- purposes of stippling. Whether rectangle /s/ is rasterized or not depends on</span>
<a name="line-105"></a><span class='hs-comment'>-- the fragment rule described for aliased lines, counting rectangles rather</span>
<a name="line-106"></a><span class='hs-comment'>-- than groups of fragments.</span>
<a name="line-107"></a><span class='hs-comment'>--</span>
<a name="line-108"></a><span class='hs-comment'>-- The initial value of 'lineStipple' is 'Nothing', i.e. line stippling is</span>
<a name="line-109"></a><span class='hs-comment'>-- disabled.</span>
<a name="line-110"></a><span class='hs-comment'>--</span>
<a name="line-111"></a><span class='hs-comment'>-- An 'Graphics.Rendering.OpenGL.GLU.Errors.InvalidOperation' is generated if</span>
<a name="line-112"></a><span class='hs-comment'>-- 'lineStipple' is set during</span>
<a name="line-113"></a><span class='hs-comment'>-- 'Graphics.Rendering.OpenGL.GL.BeginEnd.renderPrimitive'.</span>
<a name="line-114"></a>
<a name="line-115"></a><a name="lineStipple"></a><span class='hs-definition'>lineStipple</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>GLint</span><span class='hs-layout'>,</span> <span class='hs-conid'>GLushort</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-116"></a><span class='hs-definition'>lineStipple</span> <span class='hs-keyglyph'>=</span>
<a name="line-117"></a>   <span class='hs-varid'>makeStateVarMaybe</span>
<a name="line-118"></a>      <span class='hs-layout'>(</span><span class='hs-varid'>return</span> <span class='hs-conid'>CapLineStipple</span><span class='hs-layout'>)</span>
<a name="line-119"></a>      <span class='hs-layout'>(</span><span class='hs-varid'>liftM2</span> <span class='hs-conid'>(,)</span> <span class='hs-layout'>(</span><span class='hs-varid'>getInteger1</span> <span class='hs-varid'>id</span> <span class='hs-conid'>GetLineStippleRepeat</span><span class='hs-layout'>)</span>
<a name="line-120"></a>                  <span class='hs-layout'>(</span><span class='hs-varid'>getInteger1</span> <span class='hs-varid'>fromIntegral</span> <span class='hs-conid'>GetLineStipplePattern</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-121"></a>      <span class='hs-layout'>(</span><span class='hs-varid'>uncurry</span> <span class='hs-varid'>glLineStipple</span><span class='hs-layout'>)</span>
<a name="line-122"></a>
<a name="line-123"></a><span class='hs-comment'>--------------------------------------------------------------------------------</span>
<a name="line-124"></a>
<a name="line-125"></a><span class='hs-comment'>-- | Controls whether line antialiasing is enabled. The initial state is</span>
<a name="line-126"></a><span class='hs-comment'>-- 'Graphics.Rendering.OpenGL.GL.Capability.Disabled'.</span>
<a name="line-127"></a>
<a name="line-128"></a><a name="lineSmooth"></a><span class='hs-definition'>lineSmooth</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StateVar</span> <span class='hs-conid'>Capability</span>
<a name="line-129"></a><span class='hs-definition'>lineSmooth</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>makeCapability</span> <span class='hs-conid'>CapLineSmooth</span>
<a name="line-130"></a>
<a name="line-131"></a><span class='hs-comment'>--------------------------------------------------------------------------------</span>
<a name="line-132"></a>
<a name="line-133"></a><span class='hs-comment'>-- | The smallest and largest supported width of aliased lines.</span>
<a name="line-134"></a>
<a name="line-135"></a><a name="aliasedLineWidthRange"></a><span class='hs-definition'>aliasedLineWidthRange</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>GettableStateVar</span> <span class='hs-layout'>(</span><span class='hs-conid'>GLfloat</span><span class='hs-layout'>,</span> <span class='hs-conid'>GLfloat</span><span class='hs-layout'>)</span>
<a name="line-136"></a><span class='hs-definition'>aliasedLineWidthRange</span> <span class='hs-keyglyph'>=</span>
<a name="line-137"></a>   <span class='hs-varid'>makeGettableStateVar</span> <span class='hs-varop'>$</span> <span class='hs-varid'>getFloat2</span> <span class='hs-conid'>(,)</span> <span class='hs-conid'>GetAliasedLineWidthRange</span>
<a name="line-138"></a>
<a name="line-139"></a><span class='hs-comment'>-- | The smallest and largest supported width of antialiased lines.</span>
<a name="line-140"></a>
<a name="line-141"></a><a name="smoothLineWidthRange"></a><span class='hs-definition'>smoothLineWidthRange</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>GettableStateVar</span> <span class='hs-layout'>(</span><span class='hs-conid'>GLfloat</span><span class='hs-layout'>,</span> <span class='hs-conid'>GLfloat</span><span class='hs-layout'>)</span>
<a name="line-142"></a><span class='hs-definition'>smoothLineWidthRange</span> <span class='hs-keyglyph'>=</span>
<a name="line-143"></a>   <span class='hs-varid'>makeGettableStateVar</span> <span class='hs-varop'>$</span> <span class='hs-varid'>getFloat2</span> <span class='hs-conid'>(,)</span> <span class='hs-conid'>GetSmoothLineWidthRange</span>
<a name="line-144"></a>
<a name="line-145"></a><span class='hs-comment'>-- | The antialiased line width granularity, i.e. the size difference between</span>
<a name="line-146"></a><span class='hs-comment'>-- supported widths.</span>
<a name="line-147"></a>
<a name="line-148"></a><a name="smoothLineWidthGranularity"></a><span class='hs-definition'>smoothLineWidthGranularity</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>GettableStateVar</span> <span class='hs-conid'>GLfloat</span>
<a name="line-149"></a><span class='hs-definition'>smoothLineWidthGranularity</span> <span class='hs-keyglyph'>=</span>
<a name="line-150"></a>   <span class='hs-varid'>makeGettableStateVar</span> <span class='hs-varop'>$</span> <span class='hs-varid'>getFloat1</span> <span class='hs-varid'>id</span> <span class='hs-conid'>GetSmoothLineWidthGranularity</span>
</pre></body>
</html>
