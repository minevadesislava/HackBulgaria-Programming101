<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>Foreign/C/String.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE CPP, PackageImports #-}</span>
<a name="line-2"></a><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &gt;= 701</span>
<a name="line-3"></a><span class='hs-comment'>{-# LANGUAGE Safe #-}</span>
<a name="line-4"></a><span class='hs-cpp'>#endif</span>
<a name="line-5"></a>
<a name="line-6"></a><span class='hs-comment'>-- |</span>
<a name="line-7"></a><span class='hs-comment'>-- Utilities for primitive marshalling of C strings.</span>
<a name="line-8"></a><span class='hs-comment'>--</span>
<a name="line-9"></a><span class='hs-comment'>-- The marshalling converts each Haskell character, representing a Unicode</span>
<a name="line-10"></a><span class='hs-comment'>-- code point, to one or more bytes in a manner that, by default, is</span>
<a name="line-11"></a><span class='hs-comment'>-- determined by the current locale.  As a consequence, no guarantees</span>
<a name="line-12"></a><span class='hs-comment'>-- can be made about the relative length of a Haskell string and its</span>
<a name="line-13"></a><span class='hs-comment'>-- corresponding C string, and therefore all the marshalling routines</span>
<a name="line-14"></a><span class='hs-comment'>-- include memory allocation.  The translation between Unicode and the</span>
<a name="line-15"></a><span class='hs-comment'>-- encoding of the current locale may be lossy.</span>
<a name="line-16"></a>
<a name="line-17"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Foreign</span><span class='hs-varop'>.</span><span class='hs-conid'>C</span><span class='hs-varop'>.</span><span class='hs-conid'>String</span> <span class='hs-layout'>(</span>
<a name="line-18"></a>
<a name="line-19"></a>  <span class='hs-comment'>-- * C strings</span>
<a name="line-20"></a>
<a name="line-21"></a>  <span class='hs-conid'>CString</span><span class='hs-layout'>,</span>           <span class='hs-comment'>-- = Ptr CChar</span>
<a name="line-22"></a>  <span class='hs-conid'>CStringLen</span><span class='hs-layout'>,</span>        <span class='hs-comment'>-- = (Ptr CChar, Int)</span>
<a name="line-23"></a>
<a name="line-24"></a>  <span class='hs-comment'>-- ** Using a locale-dependent encoding</span>
<a name="line-25"></a>
<a name="line-26"></a>  <span class='hs-comment'>-- | Currently these functions are identical to their @CAString@ counterparts;</span>
<a name="line-27"></a>  <span class='hs-comment'>-- eventually they will use an encoding determined by the current locale.</span>
<a name="line-28"></a>
<a name="line-29"></a>  <span class='hs-comment'>-- conversion of C strings into Haskell strings</span>
<a name="line-30"></a>  <span class='hs-comment'>--</span>
<a name="line-31"></a>  <span class='hs-varid'>peekCString</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- :: CString    -&gt; IO String</span>
<a name="line-32"></a>  <span class='hs-varid'>peekCStringLen</span><span class='hs-layout'>,</span>    <span class='hs-comment'>-- :: CStringLen -&gt; IO String</span>
<a name="line-33"></a>
<a name="line-34"></a>  <span class='hs-comment'>-- conversion of Haskell strings into C strings</span>
<a name="line-35"></a>  <span class='hs-comment'>--</span>
<a name="line-36"></a>  <span class='hs-varid'>newCString</span><span class='hs-layout'>,</span>        <span class='hs-comment'>-- :: String -&gt; IO CString</span>
<a name="line-37"></a>  <span class='hs-varid'>newCStringLen</span><span class='hs-layout'>,</span>     <span class='hs-comment'>-- :: String -&gt; IO CStringLen</span>
<a name="line-38"></a>
<a name="line-39"></a>  <span class='hs-comment'>-- conversion of Haskell strings into C strings using temporary storage</span>
<a name="line-40"></a>  <span class='hs-comment'>--</span>
<a name="line-41"></a>  <span class='hs-varid'>withCString</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- :: String -&gt; (CString    -&gt; IO a) -&gt; IO a</span>
<a name="line-42"></a>  <span class='hs-varid'>withCStringLen</span><span class='hs-layout'>,</span>    <span class='hs-comment'>-- :: String -&gt; (CStringLen -&gt; IO a) -&gt; IO a</span>
<a name="line-43"></a>
<a name="line-44"></a>  <span class='hs-varid'>charIsRepresentable</span><span class='hs-layout'>,</span> <span class='hs-comment'>-- :: Char -&gt; IO Bool</span>
<a name="line-45"></a>
<a name="line-46"></a>  <span class='hs-comment'>-- ** Using 8-bit characters</span>
<a name="line-47"></a>
<a name="line-48"></a>  <span class='hs-comment'>-- | These variants of the above functions are for use with C libraries</span>
<a name="line-49"></a>  <span class='hs-comment'>-- that are ignorant of Unicode.  These functions should be used with</span>
<a name="line-50"></a>  <span class='hs-comment'>-- care, as a loss of information can occur.</span>
<a name="line-51"></a>
<a name="line-52"></a>  <span class='hs-varid'>castCharToCChar</span><span class='hs-layout'>,</span>   <span class='hs-comment'>-- :: Char -&gt; CChar</span>
<a name="line-53"></a>  <span class='hs-varid'>castCCharToChar</span><span class='hs-layout'>,</span>   <span class='hs-comment'>-- :: CChar -&gt; Char</span>
<a name="line-54"></a>
<a name="line-55"></a>  <span class='hs-varid'>castCharToCUChar</span><span class='hs-layout'>,</span>  <span class='hs-comment'>-- :: Char -&gt; CUChar</span>
<a name="line-56"></a>  <span class='hs-varid'>castCUCharToChar</span><span class='hs-layout'>,</span>  <span class='hs-comment'>-- :: CUChar -&gt; Char</span>
<a name="line-57"></a>  <span class='hs-varid'>castCharToCSChar</span><span class='hs-layout'>,</span>  <span class='hs-comment'>-- :: Char -&gt; CSChar</span>
<a name="line-58"></a>  <span class='hs-varid'>castCSCharToChar</span><span class='hs-layout'>,</span>  <span class='hs-comment'>-- :: CSChar -&gt; Char</span>
<a name="line-59"></a>
<a name="line-60"></a>  <span class='hs-varid'>peekCAString</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- :: CString    -&gt; IO String</span>
<a name="line-61"></a>  <span class='hs-varid'>peekCAStringLen</span><span class='hs-layout'>,</span>   <span class='hs-comment'>-- :: CStringLen -&gt; IO String</span>
<a name="line-62"></a>  <span class='hs-varid'>newCAString</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- :: String -&gt; IO CString</span>
<a name="line-63"></a>  <span class='hs-varid'>newCAStringLen</span><span class='hs-layout'>,</span>    <span class='hs-comment'>-- :: String -&gt; IO CStringLen</span>
<a name="line-64"></a>  <span class='hs-varid'>withCAString</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- :: String -&gt; (CString    -&gt; IO a) -&gt; IO a</span>
<a name="line-65"></a>  <span class='hs-varid'>withCAStringLen</span><span class='hs-layout'>,</span>   <span class='hs-comment'>-- :: String -&gt; (CStringLen -&gt; IO a) -&gt; IO a</span>
<a name="line-66"></a>
<a name="line-67"></a>  <span class='hs-comment'>-- * C wide strings</span>
<a name="line-68"></a>
<a name="line-69"></a>  <span class='hs-comment'>-- | These variants of the above functions are for use with C libraries</span>
<a name="line-70"></a>  <span class='hs-comment'>-- that encode Unicode using the C @wchar_t@ type in a system-dependent</span>
<a name="line-71"></a>  <span class='hs-comment'>-- way.  The only encodings supported are</span>
<a name="line-72"></a>  <span class='hs-comment'>--</span>
<a name="line-73"></a>  <span class='hs-comment'>-- * UTF-32 (the C compiler defines @__STDC_ISO_10646__@), or</span>
<a name="line-74"></a>  <span class='hs-comment'>--</span>
<a name="line-75"></a>  <span class='hs-comment'>-- * UTF-16 (as used on Windows systems).</span>
<a name="line-76"></a>
<a name="line-77"></a>  <span class='hs-conid'>CWString</span><span class='hs-layout'>,</span>          <span class='hs-comment'>-- = Ptr CWchar</span>
<a name="line-78"></a>  <span class='hs-conid'>CWStringLen</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- = (Ptr CWchar, Int)</span>
<a name="line-79"></a>
<a name="line-80"></a>  <span class='hs-varid'>peekCWString</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- :: CWString    -&gt; IO String</span>
<a name="line-81"></a>  <span class='hs-varid'>peekCWStringLen</span><span class='hs-layout'>,</span>   <span class='hs-comment'>-- :: CWStringLen -&gt; IO String</span>
<a name="line-82"></a>  <span class='hs-varid'>newCWString</span><span class='hs-layout'>,</span>       <span class='hs-comment'>-- :: String -&gt; IO CWString</span>
<a name="line-83"></a>  <span class='hs-varid'>newCWStringLen</span><span class='hs-layout'>,</span>    <span class='hs-comment'>-- :: String -&gt; IO CWStringLen</span>
<a name="line-84"></a>  <span class='hs-varid'>withCWString</span><span class='hs-layout'>,</span>      <span class='hs-comment'>-- :: String -&gt; (CWString    -&gt; IO a) -&gt; IO a</span>
<a name="line-85"></a>  <span class='hs-varid'>withCWStringLen</span><span class='hs-layout'>,</span>   <span class='hs-comment'>-- :: String -&gt; (CWStringLen -&gt; IO a) -&gt; IO a</span>
<a name="line-86"></a>
<a name="line-87"></a>  <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-88"></a><span class='hs-keyword'>import</span> <span class='hs-str'>"base"</span> <span class='hs-conid'>Foreign</span><span class='hs-varop'>.</span><span class='hs-conid'>C</span><span class='hs-varop'>.</span><span class='hs-conid'>String</span>
</pre></body>
</html>
