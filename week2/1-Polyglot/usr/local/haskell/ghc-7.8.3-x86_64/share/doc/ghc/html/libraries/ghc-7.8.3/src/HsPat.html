<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>hsSyn/HsPat.lhs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
%
% (c) The University of Glasgow 2006
% (c) The GRASP/AQUA Project, Glasgow University, 1992-1998
%
\section[PatSyntax]{Abstract Haskell syntax---patterns}

\begin{code}
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE DeriveDataTypeable #-}</span>
<a name="line-2"></a>
<a name="line-3"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>HsPat</span> <span class='hs-layout'>(</span>
<a name="line-4"></a>        <span class='hs-conid'>Pat</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>InPat</span><span class='hs-layout'>,</span> <span class='hs-conid'>OutPat</span><span class='hs-layout'>,</span> <span class='hs-conid'>LPat</span><span class='hs-layout'>,</span>
<a name="line-5"></a>
<a name="line-6"></a>        <span class='hs-conid'>HsConDetails</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-7"></a>        <span class='hs-conid'>HsConPatDetails</span><span class='hs-layout'>,</span> <span class='hs-varid'>hsConPatArgs</span><span class='hs-layout'>,</span>
<a name="line-8"></a>        <span class='hs-conid'>HsRecFields</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>HsRecField</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>hsRecFields</span><span class='hs-layout'>,</span>
<a name="line-9"></a>
<a name="line-10"></a>        <span class='hs-varid'>mkPrefixConPat</span><span class='hs-layout'>,</span> <span class='hs-varid'>mkCharLitPat</span><span class='hs-layout'>,</span> <span class='hs-varid'>mkNilPat</span><span class='hs-layout'>,</span>
<a name="line-11"></a>
<a name="line-12"></a>        <span class='hs-varid'>isStrictHsBind</span><span class='hs-layout'>,</span> <span class='hs-varid'>looksLazyPatBind</span><span class='hs-layout'>,</span>
<a name="line-13"></a>        <span class='hs-varid'>isStrictLPat</span><span class='hs-layout'>,</span> <span class='hs-varid'>hsPatNeedsParens</span><span class='hs-layout'>,</span>
<a name="line-14"></a>        <span class='hs-varid'>isIrrefutableHsPat</span><span class='hs-layout'>,</span>
<a name="line-15"></a>
<a name="line-16"></a>        <span class='hs-varid'>pprParendLPat</span>
<a name="line-17"></a>    <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-18"></a>
<a name="line-19"></a><span class='hs-keyword'>import</span> <span class='hs-comment'>{-# SOURCE #-}</span> <span class='hs-conid'>HsExpr</span>            <span class='hs-layout'>(</span><span class='hs-conid'>SyntaxExpr</span><span class='hs-layout'>,</span> <span class='hs-conid'>LHsExpr</span><span class='hs-layout'>,</span> <span class='hs-conid'>HsSplice</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprLExpr</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprUntypedSplice</span><span class='hs-layout'>)</span>
<a name="line-20"></a>
<a name="line-21"></a><span class='hs-comment'>-- friends:</span>
<a name="line-22"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>HsBinds</span>
<a name="line-23"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>HsLit</span>
<a name="line-24"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>HsTypes</span>
<a name="line-25"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>TcEvidence</span>
<a name="line-26"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>BasicTypes</span>
<a name="line-27"></a><span class='hs-comment'>-- others:</span>
<a name="line-28"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>PprCore</span>          <span class='hs-layout'>(</span> <span class='hs-comment'>{- instance OutputableBndr TyVar -}</span> <span class='hs-layout'>)</span>
<a name="line-29"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>TysWiredIn</span>
<a name="line-30"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Var</span>
<a name="line-31"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>ConLike</span>
<a name="line-32"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>DataCon</span>
<a name="line-33"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>TyCon</span>
<a name="line-34"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Outputable</span>
<a name="line-35"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Type</span>
<a name="line-36"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>SrcLoc</span>
<a name="line-37"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>FastString</span>
<a name="line-38"></a><span class='hs-comment'>-- libraries:</span>
<a name="line-39"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Data</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-conid'>TyCon</span><span class='hs-layout'>)</span>
<a name="line-40"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Maybe</span>
</pre>\end{code}


\begin{code}
<pre><a name="line-1"></a><a name="InPat"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>InPat</span> <span class='hs-varid'>id</span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span>        <span class='hs-comment'>-- No 'Out' constructors</span>
<a name="line-2"></a><a name="OutPat"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>OutPat</span> <span class='hs-varid'>id</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span>        <span class='hs-comment'>-- No 'In' constructors</span>
<a name="line-3"></a>
<a name="line-4"></a><a name="LPat"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Located</span> <span class='hs-layout'>(</span><span class='hs-conid'>Pat</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>
<a name="line-5"></a>
<a name="line-6"></a><a name="Pat"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>id</span>
<a name="line-7"></a>  <span class='hs-keyglyph'>=</span>     <span class='hs-comment'>------------ Simple patterns ---------------</span>
<a name="line-8"></a>    <span class='hs-conid'>WildPat</span>     <span class='hs-conid'>PostTcType</span>              <span class='hs-comment'>-- Wild card</span>
<a name="line-9"></a>        <span class='hs-comment'>-- The sole reason for a type on a WildPat is to</span>
<a name="line-10"></a>        <span class='hs-comment'>-- support hsPatType :: Pat Id -&gt; Type</span>
<a name="line-11"></a>
<a name="line-12"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>VarPat</span>      <span class='hs-varid'>id</span>                      <span class='hs-comment'>-- Variable</span>
<a name="line-13"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>LazyPat</span>     <span class='hs-layout'>(</span><span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>               <span class='hs-comment'>-- Lazy pattern</span>
<a name="line-14"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>AsPat</span>       <span class='hs-layout'>(</span><span class='hs-conid'>Located</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>  <span class='hs-comment'>-- As pattern</span>
<a name="line-15"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ParPat</span>      <span class='hs-layout'>(</span><span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>               <span class='hs-comment'>-- Parenthesised pattern</span>
<a name="line-16"></a>                                        <span class='hs-comment'>-- See Note [Parens in HsSyn] in HsExpr</span>
<a name="line-17"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>BangPat</span>     <span class='hs-layout'>(</span><span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>               <span class='hs-comment'>-- Bang pattern</span>
<a name="line-18"></a>
<a name="line-19"></a>        <span class='hs-comment'>------------ Lists, tuples, arrays ---------------</span>
<a name="line-20"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ListPat</span>     <span class='hs-keyglyph'>[</span><span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span><span class='hs-keyglyph'>]</span>                            <span class='hs-comment'>-- Syntactic list</span>
<a name="line-21"></a>                <span class='hs-conid'>PostTcType</span>                           <span class='hs-comment'>-- The type of the elements</span>
<a name="line-22"></a>                <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>PostTcType</span><span class='hs-layout'>,</span> <span class='hs-conid'>SyntaxExpr</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>  <span class='hs-comment'>-- For rebindable syntax</span>
<a name="line-23"></a>                   <span class='hs-comment'>-- For OverloadedLists a Just (ty,fn) gives</span>
<a name="line-24"></a>                   <span class='hs-comment'>-- overall type of the pattern, and the toList</span>
<a name="line-25"></a>                   <span class='hs-comment'>-- function to convert the scrutinee to a list value</span>
<a name="line-26"></a>
<a name="line-27"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>TuplePat</span>    <span class='hs-keyglyph'>[</span><span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span><span class='hs-keyglyph'>]</span>    <span class='hs-comment'>-- Tuple sub-patterns</span>
<a name="line-28"></a>                <span class='hs-conid'>Boxity</span>       <span class='hs-comment'>-- UnitPat is TuplePat []</span>
<a name="line-29"></a>                <span class='hs-keyglyph'>[</span><span class='hs-conid'>PostTcType</span><span class='hs-keyglyph'>]</span> <span class='hs-comment'>-- [] before typechecker, filled in afterwards with</span>
<a name="line-30"></a>                             <span class='hs-comment'>-- the types of the tuple components</span>
<a name="line-31"></a>        <span class='hs-comment'>-- You might think that the PostTcType was redundant, because we can </span>
<a name="line-32"></a>        <span class='hs-comment'>-- get the pattern type by getting the types of the sub-patterns.</span>
<a name="line-33"></a>        <span class='hs-comment'>-- But it's essential</span>
<a name="line-34"></a>        <span class='hs-comment'>--      data T a where</span>
<a name="line-35"></a>        <span class='hs-comment'>--        T1 :: Int -&gt; T Int</span>
<a name="line-36"></a>        <span class='hs-comment'>--      f :: (T a, a) -&gt; Int</span>
<a name="line-37"></a>        <span class='hs-comment'>--      f (T1 x, z) = z</span>
<a name="line-38"></a>        <span class='hs-comment'>-- When desugaring, we must generate</span>
<a name="line-39"></a>        <span class='hs-comment'>--      f = /\a. \v::a.  case v of (t::T a, w::a) -&gt;</span>
<a name="line-40"></a>        <span class='hs-comment'>--                       case t of (T1 (x::Int)) -&gt;</span>
<a name="line-41"></a>        <span class='hs-comment'>-- Note the (w::a), NOT (w::Int), because we have not yet</span>
<a name="line-42"></a>        <span class='hs-comment'>-- refined 'a' to Int.  So we must know that the second component</span>
<a name="line-43"></a>        <span class='hs-comment'>-- of the tuple is of type 'a' not Int.  See selectMatchVar</span>
<a name="line-44"></a>        <span class='hs-comment'>-- (June 14: I'm not sure this comment is right; the sub-patterns</span>
<a name="line-45"></a>        <span class='hs-comment'>--           will be wrapped in CoPats, no?)</span>
<a name="line-46"></a>
<a name="line-47"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>PArrPat</span>     <span class='hs-keyglyph'>[</span><span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span><span class='hs-keyglyph'>]</span>               <span class='hs-comment'>-- Syntactic parallel array</span>
<a name="line-48"></a>                <span class='hs-conid'>PostTcType</span>              <span class='hs-comment'>-- The type of the elements</span>
<a name="line-49"></a>
<a name="line-50"></a>        <span class='hs-comment'>------------ Constructor patterns ---------------</span>
<a name="line-51"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConPatIn</span>    <span class='hs-layout'>(</span><span class='hs-conid'>Located</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>
<a name="line-52"></a>                <span class='hs-layout'>(</span><span class='hs-conid'>HsConPatDetails</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>
<a name="line-53"></a>
<a name="line-54"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConPatOut</span> <span class='hs-layout'>{</span>
<a name="line-55"></a>        <span class='hs-varid'>pat_con</span>     <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Located</span> <span class='hs-conid'>ConLike</span><span class='hs-layout'>,</span>
<a name="line-56"></a>        <span class='hs-varid'>pat_arg_tys</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Type</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>          <span class='hs-comment'>-- The univeral arg types, 1-1 with the universal</span>
<a name="line-57"></a>                                        <span class='hs-comment'>-- tyvars of the constructor/pattern synonym</span>
<a name="line-58"></a>                                        <span class='hs-comment'>--   Use (conLikeResTy pat_con pat_arg_tys) to get </span>
<a name="line-59"></a>                                        <span class='hs-comment'>--   the type of the pattern</span>
<a name="line-60"></a>
<a name="line-61"></a>        <span class='hs-varid'>pat_tvs</span>   <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>TyVar</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>           <span class='hs-comment'>-- Existentially bound type variables (tyvars only)</span>
<a name="line-62"></a>        <span class='hs-varid'>pat_dicts</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>EvVar</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>           <span class='hs-comment'>-- Ditto *coercion variables* and *dictionaries*</span>
<a name="line-63"></a>                                        <span class='hs-comment'>-- One reason for putting coercion variable here, I think,</span>
<a name="line-64"></a>                                        <span class='hs-comment'>--      is to ensure their kinds are zonked</span>
<a name="line-65"></a>        <span class='hs-varid'>pat_binds</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>TcEvBinds</span><span class='hs-layout'>,</span>         <span class='hs-comment'>-- Bindings involving those dictionaries</span>
<a name="line-66"></a>        <span class='hs-varid'>pat_args</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsConPatDetails</span> <span class='hs-varid'>id</span><span class='hs-layout'>,</span>
<a name="line-67"></a>        <span class='hs-varid'>pat_wrap</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsWrapper</span>          <span class='hs-comment'>-- Extra wrapper to pass to the matcher</span>
<a name="line-68"></a>    <span class='hs-layout'>}</span>
<a name="line-69"></a>
<a name="line-70"></a>        <span class='hs-comment'>------------ View patterns ---------------</span>
<a name="line-71"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ViewPat</span>       <span class='hs-layout'>(</span><span class='hs-conid'>LHsExpr</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>
<a name="line-72"></a>                  <span class='hs-layout'>(</span><span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>
<a name="line-73"></a>                  <span class='hs-conid'>PostTcType</span>        <span class='hs-comment'>-- The overall type of the pattern</span>
<a name="line-74"></a>                                    <span class='hs-comment'>-- (= the argument type of the view function)</span>
<a name="line-75"></a>                                    <span class='hs-comment'>-- for hsPatType.</span>
<a name="line-76"></a>
<a name="line-77"></a>        <span class='hs-comment'>------------ Pattern splices ---------------</span>
<a name="line-78"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>SplicePat</span>       <span class='hs-layout'>(</span><span class='hs-conid'>HsSplice</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>
<a name="line-79"></a>
<a name="line-80"></a>        <span class='hs-comment'>------------ Quasiquoted patterns ---------------</span>
<a name="line-81"></a>        <span class='hs-comment'>-- See Note [Quasi-quote overview] in TcSplice</span>
<a name="line-82"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>QuasiQuotePat</span>   <span class='hs-layout'>(</span><span class='hs-conid'>HsQuasiQuote</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>
<a name="line-83"></a>
<a name="line-84"></a>        <span class='hs-comment'>------------ Literal and n+k patterns ---------------</span>
<a name="line-85"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>LitPat</span>          <span class='hs-conid'>HsLit</span>               <span class='hs-comment'>-- Used for *non-overloaded* literal patterns:</span>
<a name="line-86"></a>                                        <span class='hs-comment'>-- Int#, Char#, Int, Char, String, etc.</span>
<a name="line-87"></a>
<a name="line-88"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>NPat</span>                <span class='hs-comment'>-- Used for all overloaded literals,</span>
<a name="line-89"></a>                        <span class='hs-comment'>-- including overloaded strings with -XOverloadedStrings</span>
<a name="line-90"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>HsOverLit</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>              <span class='hs-comment'>-- ALWAYS positive</span>
<a name="line-91"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>Maybe</span> <span class='hs-layout'>(</span><span class='hs-conid'>SyntaxExpr</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>     <span class='hs-comment'>-- Just (Name of 'negate') for negative</span>
<a name="line-92"></a>                                                <span class='hs-comment'>-- patterns, Nothing otherwise</span>
<a name="line-93"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>SyntaxExpr</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>             <span class='hs-comment'>-- Equality checker, of type t-&gt;t-&gt;Bool</span>
<a name="line-94"></a>
<a name="line-95"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>NPlusKPat</span>       <span class='hs-layout'>(</span><span class='hs-conid'>Located</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>        <span class='hs-comment'>-- n+k pattern</span>
<a name="line-96"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>HsOverLit</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>      <span class='hs-comment'>-- It'll always be an HsIntegral</span>
<a name="line-97"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>SyntaxExpr</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>     <span class='hs-comment'>-- (&gt;=) function, of type t-&gt;t-&gt;Bool</span>
<a name="line-98"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>SyntaxExpr</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>     <span class='hs-comment'>-- Name of '-' (see RnEnv.lookupSyntaxName)</span>
<a name="line-99"></a>
<a name="line-100"></a>        <span class='hs-comment'>------------ Pattern type signatures ---------------</span>
<a name="line-101"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>SigPatIn</span>        <span class='hs-layout'>(</span><span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>                   <span class='hs-comment'>-- Pattern with a type signature</span>
<a name="line-102"></a>                    <span class='hs-layout'>(</span><span class='hs-conid'>HsWithBndrs</span> <span class='hs-layout'>(</span><span class='hs-conid'>LHsType</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>  <span class='hs-comment'>-- Signature can bind both kind and type vars</span>
<a name="line-103"></a>
<a name="line-104"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>SigPatOut</span>       <span class='hs-layout'>(</span><span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>           <span class='hs-comment'>-- Pattern with a type signature</span>
<a name="line-105"></a>                    <span class='hs-conid'>Type</span>
<a name="line-106"></a>
<a name="line-107"></a>        <span class='hs-comment'>------------ Pattern coercions (translation only) ---------------</span>
<a name="line-108"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>CoPat</span>       <span class='hs-conid'>HsWrapper</span>               <span class='hs-comment'>-- If co :: t1 ~ t2, p :: t2,</span>
<a name="line-109"></a>                                        <span class='hs-comment'>-- then (CoPat co p) :: t1</span>
<a name="line-110"></a>                <span class='hs-layout'>(</span><span class='hs-conid'>Pat</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span>                <span class='hs-comment'>-- Why not LPat?  Ans: existing locn will do</span>
<a name="line-111"></a>                <span class='hs-conid'>Type</span>                    <span class='hs-comment'>-- Type of whole pattern, t1</span>
<a name="line-112"></a>        <span class='hs-comment'>-- During desugaring a (CoPat co pat) turns into a cast with 'co' on</span>
<a name="line-113"></a>        <span class='hs-comment'>-- the scrutinee, followed by a match on 'pat'</span>
<a name="line-114"></a>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span><span class='hs-layout'>)</span>
</pre>\end{code}

HsConDetails is use for patterns/expressions *and* for data type declarations

\begin{code}
<pre><a name="line-1"></a><a name="HsConDetails"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>HsConDetails</span> <span class='hs-varid'>arg</span> <span class='hs-varid'>rec</span>
<a name="line-2"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PrefixCon</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>arg</span><span class='hs-keyglyph'>]</span>             <span class='hs-comment'>-- C p1 p2 p3</span>
<a name="line-3"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>RecCon</span>    <span class='hs-varid'>rec</span>               <span class='hs-comment'>-- C { x = p1, y = p2 }</span>
<a name="line-4"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>InfixCon</span>  <span class='hs-varid'>arg</span> <span class='hs-varid'>arg</span>           <span class='hs-comment'>-- p1 `C` p2</span>
<a name="line-5"></a>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span><span class='hs-layout'>)</span>
<a name="line-6"></a>
<a name="line-7"></a><a name="HsConPatDetails"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>HsConPatDetails</span> <span class='hs-varid'>id</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>HsConDetails</span> <span class='hs-layout'>(</span><span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsRecFields</span> <span class='hs-varid'>id</span> <span class='hs-layout'>(</span><span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-8"></a>
<a name="line-9"></a><a name="hsConPatArgs"></a><span class='hs-definition'>hsConPatArgs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsConPatDetails</span> <span class='hs-varid'>id</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span><span class='hs-keyglyph'>]</span>
<a name="line-10"></a><span class='hs-definition'>hsConPatArgs</span> <span class='hs-layout'>(</span><span class='hs-conid'>PrefixCon</span> <span class='hs-varid'>ps</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ps</span>
<a name="line-11"></a><span class='hs-definition'>hsConPatArgs</span> <span class='hs-layout'>(</span><span class='hs-conid'>RecCon</span> <span class='hs-varid'>fs</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-varid'>hsRecFieldArg</span> <span class='hs-layout'>(</span><span class='hs-varid'>rec_flds</span> <span class='hs-varid'>fs</span><span class='hs-layout'>)</span>
<a name="line-12"></a><span class='hs-definition'>hsConPatArgs</span> <span class='hs-layout'>(</span><span class='hs-conid'>InfixCon</span> <span class='hs-varid'>p1</span> <span class='hs-varid'>p2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>p1</span><span class='hs-layout'>,</span><span class='hs-varid'>p2</span><span class='hs-keyglyph'>]</span>
</pre>\end{code}

However HsRecFields is used only for patterns and expressions
(not data type declarations)

\begin{code}
<pre><a name="line-1"></a><a name="HsRecFields"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>HsRecFields</span> <span class='hs-varid'>id</span> <span class='hs-varid'>arg</span>         <span class='hs-comment'>-- A bunch of record fields</span>
<a name="line-2"></a>                                <span class='hs-comment'>--      { x = 3, y = True }</span>
<a name="line-3"></a>        <span class='hs-comment'>-- Used for both expressions and patterns</span>
<a name="line-4"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>HsRecFields</span> <span class='hs-layout'>{</span> <span class='hs-varid'>rec_flds</span>   <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>HsRecField</span> <span class='hs-varid'>id</span> <span class='hs-varid'>arg</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span>
<a name="line-5"></a>                  <span class='hs-varid'>rec_dotdot</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Maybe</span> <span class='hs-conid'>Int</span> <span class='hs-layout'>}</span>  <span class='hs-comment'>-- Note [DotDot fields]</span>
<a name="line-6"></a>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span><span class='hs-layout'>)</span>
<a name="line-7"></a>
<a name="line-8"></a><span class='hs-comment'>-- Note [DotDot fields]</span>
<a name="line-9"></a><span class='hs-comment'>-- ~~~~~~~~~~~~~~~~~~~~</span>
<a name="line-10"></a><span class='hs-comment'>-- The rec_dotdot field means this:</span>
<a name="line-11"></a><span class='hs-comment'>--   Nothing =&gt; the normal case</span>
<a name="line-12"></a><span class='hs-comment'>--   Just n  =&gt; the group uses ".." notation,</span>
<a name="line-13"></a><span class='hs-comment'>--</span>
<a name="line-14"></a><span class='hs-comment'>-- In the latter case:</span>
<a name="line-15"></a><span class='hs-comment'>--</span>
<a name="line-16"></a><span class='hs-comment'>--   *before* renamer: rec_flds are exactly the n user-written fields</span>
<a name="line-17"></a><span class='hs-comment'>--</span>
<a name="line-18"></a><span class='hs-comment'>--   *after* renamer:  rec_flds includes *all* fields, with</span>
<a name="line-19"></a><span class='hs-comment'>--                     the first 'n' being the user-written ones</span>
<a name="line-20"></a><span class='hs-comment'>--                     and the remainder being 'filled in' implicitly</span>
<a name="line-21"></a>
<a name="line-22"></a><a name="HsRecField"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>HsRecField</span> <span class='hs-varid'>id</span> <span class='hs-varid'>arg</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>HsRecField</span> <span class='hs-layout'>{</span>
<a name="line-23"></a>        <span class='hs-varid'>hsRecFieldId</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Located</span> <span class='hs-varid'>id</span><span class='hs-layout'>,</span>
<a name="line-24"></a>        <span class='hs-varid'>hsRecFieldArg</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>arg</span><span class='hs-layout'>,</span>           <span class='hs-comment'>-- Filled in by renamer</span>
<a name="line-25"></a>        <span class='hs-varid'>hsRecPun</span>      <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span>           <span class='hs-comment'>-- Note [Punning]</span>
<a name="line-26"></a>  <span class='hs-layout'>}</span> <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Data</span><span class='hs-layout'>,</span> <span class='hs-conid'>Typeable</span><span class='hs-layout'>)</span>
<a name="line-27"></a>
<a name="line-28"></a><span class='hs-comment'>-- Note [Punning]</span>
<a name="line-29"></a><span class='hs-comment'>-- ~~~~~~~~~~~~~~</span>
<a name="line-30"></a><span class='hs-comment'>-- If you write T { x, y = v+1 }, the HsRecFields will be</span>
<a name="line-31"></a><span class='hs-comment'>--      HsRecField x x True ...</span>
<a name="line-32"></a><span class='hs-comment'>--      HsRecField y (v+1) False ...</span>
<a name="line-33"></a><span class='hs-comment'>-- That is, for "punned" field x is expanded (in the renamer)</span>
<a name="line-34"></a><span class='hs-comment'>-- to x=x; but with a punning flag so we can detect it later</span>
<a name="line-35"></a><span class='hs-comment'>-- (e.g. when pretty printing)</span>
<a name="line-36"></a><span class='hs-comment'>--</span>
<a name="line-37"></a><span class='hs-comment'>-- If the original field was qualified, we un-qualify it, thus</span>
<a name="line-38"></a><span class='hs-comment'>--    T { A.x } means T { A.x = x }</span>
<a name="line-39"></a>
<a name="line-40"></a><a name="hsRecFields"></a><span class='hs-definition'>hsRecFields</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsRecFields</span> <span class='hs-varid'>id</span> <span class='hs-varid'>arg</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>id</span><span class='hs-keyglyph'>]</span>
<a name="line-41"></a><span class='hs-definition'>hsRecFields</span> <span class='hs-varid'>rbinds</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varop'>.</span> <span class='hs-varid'>hsRecFieldId</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>rec_flds</span> <span class='hs-varid'>rbinds</span><span class='hs-layout'>)</span>
</pre>\end{code}

%************************************************************************
%*                                                                      *
%*              Printing patterns
%*                                                                      *
%************************************************************************

\begin{code}
<pre><a name="line-1"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndr</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>Pat</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-2"></a>    <span class='hs-varid'>ppr</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPat</span>
<a name="line-3"></a>
<a name="line-4"></a><a name="pprPatBndr"></a><span class='hs-definition'>pprPatBndr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>OutputableBndr</span> <span class='hs-varid'>name</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>name</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-5"></a><span class='hs-definition'>pprPatBndr</span> <span class='hs-varid'>var</span>                  <span class='hs-comment'>-- Print with type info if -dppr-debug is on</span>
<a name="line-6"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>getPprStyle</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span> <span class='hs-varid'>sty</span> <span class='hs-keyglyph'>-&gt;</span>
<a name="line-7"></a>    <span class='hs-keyword'>if</span> <span class='hs-varid'>debugStyle</span> <span class='hs-varid'>sty</span> <span class='hs-keyword'>then</span>
<a name="line-8"></a>        <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprBndr</span> <span class='hs-conid'>LambdaBind</span> <span class='hs-varid'>var</span><span class='hs-layout'>)</span>         <span class='hs-comment'>-- Could pass the site to pprPat</span>
<a name="line-9"></a>                                                <span class='hs-comment'>-- but is it worth it?</span>
<a name="line-10"></a>    <span class='hs-keyword'>else</span>
<a name="line-11"></a>        <span class='hs-varid'>pprPrefixOcc</span> <span class='hs-varid'>var</span>
<a name="line-12"></a>
<a name="line-13"></a><a name="pprParendLPat"></a><span class='hs-definition'>pprParendLPat</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndr</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>LPat</span> <span class='hs-varid'>name</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-14"></a><span class='hs-definition'>pprParendLPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprParendPat</span> <span class='hs-varid'>p</span>
<a name="line-15"></a>
<a name="line-16"></a><a name="pprParendPat"></a><span class='hs-definition'>pprParendPat</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndr</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>name</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-17"></a><span class='hs-definition'>pprParendPat</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>hsPatNeedsParens</span> <span class='hs-varid'>p</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>pprPat</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-18"></a>               <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>          <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPat</span> <span class='hs-varid'>p</span>
<a name="line-19"></a>
<a name="line-20"></a><a name="pprPat"></a><span class='hs-definition'>pprPat</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndr</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>name</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-21"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>VarPat</span> <span class='hs-varid'>var</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPatBndr</span> <span class='hs-varid'>var</span>
<a name="line-22"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>WildPat</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'_'</span>
<a name="line-23"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>LazyPat</span> <span class='hs-varid'>pat</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'~'</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>pprParendLPat</span> <span class='hs-varid'>pat</span>
<a name="line-24"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>BangPat</span> <span class='hs-varid'>pat</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'!'</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>pprParendLPat</span> <span class='hs-varid'>pat</span>
<a name="line-25"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>AsPat</span> <span class='hs-varid'>name</span> <span class='hs-varid'>pat</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hcat</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pprPrefixOcc</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>name</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'@'</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprParendLPat</span> <span class='hs-varid'>pat</span><span class='hs-keyglyph'>]</span>
<a name="line-26"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>ViewPat</span> <span class='hs-varid'>expr</span> <span class='hs-varid'>pat</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hcat</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pprLExpr</span> <span class='hs-varid'>expr</span><span class='hs-layout'>,</span> <span class='hs-varid'>text</span> <span class='hs-str'>" -&gt; "</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>pat</span><span class='hs-keyglyph'>]</span>
<a name="line-27"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>ParPat</span> <span class='hs-varid'>pat</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-varid'>parens</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>pat</span><span class='hs-layout'>)</span>
<a name="line-28"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>ListPat</span> <span class='hs-varid'>pats</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>brackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>interpp'SP</span> <span class='hs-varid'>pats</span><span class='hs-layout'>)</span>
<a name="line-29"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>PArrPat</span> <span class='hs-varid'>pats</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>paBrackets</span> <span class='hs-layout'>(</span><span class='hs-varid'>interpp'SP</span> <span class='hs-varid'>pats</span><span class='hs-layout'>)</span>
<a name="line-30"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>TuplePat</span> <span class='hs-varid'>pats</span> <span class='hs-varid'>bx</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tupleParens</span> <span class='hs-layout'>(</span><span class='hs-varid'>boxityNormalTupleSort</span> <span class='hs-varid'>bx</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>interpp'SP</span> <span class='hs-varid'>pats</span><span class='hs-layout'>)</span>
<a name="line-31"></a>
<a name="line-32"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>ConPatIn</span> <span class='hs-varid'>con</span> <span class='hs-varid'>details</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprUserCon</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>con</span><span class='hs-layout'>)</span> <span class='hs-varid'>details</span>
<a name="line-33"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>ConPatOut</span> <span class='hs-layout'>{</span> <span class='hs-varid'>pat_con</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>con</span><span class='hs-layout'>,</span> <span class='hs-varid'>pat_tvs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tvs</span><span class='hs-layout'>,</span> <span class='hs-varid'>pat_dicts</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>dicts</span><span class='hs-layout'>,</span>
<a name="line-34"></a>                    <span class='hs-varid'>pat_binds</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>binds</span><span class='hs-layout'>,</span> <span class='hs-varid'>pat_args</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>details</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-35"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>getPprStyle</span> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span> <span class='hs-varid'>sty</span> <span class='hs-keyglyph'>-&gt;</span>      <span class='hs-comment'>-- Tiresome; in TcBinds.tcRhs we print out a</span>
<a name="line-36"></a>    <span class='hs-keyword'>if</span> <span class='hs-varid'>debugStyle</span> <span class='hs-varid'>sty</span> <span class='hs-keyword'>then</span>      <span class='hs-comment'>-- typechecked Pat in an error message,</span>
<a name="line-37"></a>                                <span class='hs-comment'>-- and we want to make sure it prints nicely</span>
<a name="line-38"></a>        <span class='hs-varid'>ppr</span> <span class='hs-varid'>con</span>
<a name="line-39"></a>          <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>braces</span> <span class='hs-layout'>(</span><span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>hsep</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>pprPatBndr</span> <span class='hs-layout'>(</span><span class='hs-varid'>tvs</span> <span class='hs-varop'>++</span> <span class='hs-varid'>dicts</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-40"></a>                         <span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>binds</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-41"></a>          <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprConArgs</span> <span class='hs-varid'>details</span>
<a name="line-42"></a>    <span class='hs-keyword'>else</span> <span class='hs-varid'>pprUserCon</span> <span class='hs-layout'>(</span><span class='hs-varid'>unLoc</span> <span class='hs-varid'>con</span><span class='hs-layout'>)</span> <span class='hs-varid'>details</span>
<a name="line-43"></a>
<a name="line-44"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>LitPat</span> <span class='hs-varid'>s</span><span class='hs-layout'>)</span>           <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>s</span>
<a name="line-45"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>NPat</span> <span class='hs-varid'>l</span> <span class='hs-conid'>Nothing</span>  <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>l</span>
<a name="line-46"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>NPat</span> <span class='hs-varid'>l</span> <span class='hs-layout'>(</span><span class='hs-conid'>Just</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'-'</span> <span class='hs-varop'>&lt;&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>l</span>
<a name="line-47"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>NPlusKPat</span> <span class='hs-varid'>n</span> <span class='hs-varid'>k</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hcat</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>n</span><span class='hs-layout'>,</span> <span class='hs-varid'>char</span> <span class='hs-chr'>'+'</span><span class='hs-layout'>,</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>k</span><span class='hs-keyglyph'>]</span>
<a name="line-48"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>SplicePat</span> <span class='hs-varid'>splice</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprUntypedSplice</span> <span class='hs-varid'>splice</span>
<a name="line-49"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>QuasiQuotePat</span> <span class='hs-varid'>qq</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>qq</span>
<a name="line-50"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>CoPat</span> <span class='hs-varid'>co</span> <span class='hs-varid'>pat</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprHsWrapper</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>pat</span><span class='hs-layout'>)</span> <span class='hs-varid'>co</span>
<a name="line-51"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>SigPatIn</span> <span class='hs-varid'>pat</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>pat</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>dcolon</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ty</span>
<a name="line-52"></a><span class='hs-definition'>pprPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>SigPatOut</span> <span class='hs-varid'>pat</span> <span class='hs-varid'>ty</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>pat</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>dcolon</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>ty</span>
<a name="line-53"></a>
<a name="line-54"></a><a name="pprUserCon"></a><span class='hs-definition'>pprUserCon</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndr</span> <span class='hs-varid'>con</span><span class='hs-layout'>,</span> <span class='hs-conid'>OutputableBndr</span> <span class='hs-varid'>id</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>con</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HsConPatDetails</span> <span class='hs-varid'>id</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-55"></a><span class='hs-definition'>pprUserCon</span> <span class='hs-varid'>c</span> <span class='hs-layout'>(</span><span class='hs-conid'>InfixCon</span> <span class='hs-varid'>p1</span> <span class='hs-varid'>p2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>p1</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprInfixOcc</span> <span class='hs-varid'>c</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>p2</span>
<a name="line-56"></a><span class='hs-definition'>pprUserCon</span> <span class='hs-varid'>c</span> <span class='hs-varid'>details</span>          <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPrefixOcc</span> <span class='hs-varid'>c</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>pprConArgs</span> <span class='hs-varid'>details</span>
<a name="line-57"></a>
<a name="line-58"></a><a name="pprConArgs"></a><span class='hs-definition'>pprConArgs</span> <span class='hs-keyglyph'>::</span>  <span class='hs-conid'>OutputableBndr</span> <span class='hs-varid'>id</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HsConPatDetails</span> <span class='hs-varid'>id</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SDoc</span>
<a name="line-59"></a><span class='hs-definition'>pprConArgs</span> <span class='hs-layout'>(</span><span class='hs-conid'>PrefixCon</span> <span class='hs-varid'>pats</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>pprParendLPat</span> <span class='hs-varid'>pats</span><span class='hs-layout'>)</span>
<a name="line-60"></a><span class='hs-definition'>pprConArgs</span> <span class='hs-layout'>(</span><span class='hs-conid'>InfixCon</span> <span class='hs-varid'>p1</span> <span class='hs-varid'>p2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>sep</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>pprParendLPat</span> <span class='hs-varid'>p1</span><span class='hs-layout'>,</span> <span class='hs-varid'>pprParendLPat</span> <span class='hs-varid'>p2</span><span class='hs-keyglyph'>]</span>
<a name="line-61"></a><span class='hs-definition'>pprConArgs</span> <span class='hs-layout'>(</span><span class='hs-conid'>RecCon</span> <span class='hs-varid'>rpats</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>rpats</span>
<a name="line-62"></a>
<a name="line-63"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndr</span> <span class='hs-varid'>id</span><span class='hs-layout'>,</span> <span class='hs-conid'>Outputable</span> <span class='hs-varid'>arg</span><span class='hs-layout'>)</span>
<a name="line-64"></a>      <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsRecFields</span> <span class='hs-varid'>id</span> <span class='hs-varid'>arg</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-65"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsRecFields</span> <span class='hs-layout'>{</span> <span class='hs-varid'>rec_flds</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>flds</span><span class='hs-layout'>,</span> <span class='hs-varid'>rec_dotdot</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nothing</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-66"></a>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>braces</span> <span class='hs-layout'>(</span><span class='hs-varid'>fsep</span> <span class='hs-layout'>(</span><span class='hs-varid'>punctuate</span> <span class='hs-varid'>comma</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>flds</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-67"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsRecFields</span> <span class='hs-layout'>{</span> <span class='hs-varid'>rec_flds</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>flds</span><span class='hs-layout'>,</span> <span class='hs-varid'>rec_dotdot</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Just</span> <span class='hs-varid'>n</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-68"></a>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>braces</span> <span class='hs-layout'>(</span><span class='hs-varid'>fsep</span> <span class='hs-layout'>(</span><span class='hs-varid'>punctuate</span> <span class='hs-varid'>comma</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-varid'>take</span> <span class='hs-varid'>n</span> <span class='hs-varid'>flds</span><span class='hs-layout'>)</span> <span class='hs-varop'>++</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>dotdot</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-69"></a>        <span class='hs-keyword'>where</span>
<a name="line-70"></a>          <span class='hs-varid'>dotdot</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ptext</span> <span class='hs-layout'>(</span><span class='hs-varid'>sLit</span> <span class='hs-str'>".."</span><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ifPprDebug</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-varid'>drop</span> <span class='hs-varid'>n</span> <span class='hs-varid'>flds</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-71"></a>
<a name="line-72"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>OutputableBndr</span> <span class='hs-varid'>id</span><span class='hs-layout'>,</span> <span class='hs-conid'>Outputable</span> <span class='hs-varid'>arg</span><span class='hs-layout'>)</span>
<a name="line-73"></a>      <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Outputable</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsRecField</span> <span class='hs-varid'>id</span> <span class='hs-varid'>arg</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-74"></a>  <span class='hs-varid'>ppr</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsRecField</span> <span class='hs-layout'>{</span> <span class='hs-varid'>hsRecFieldId</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>f</span><span class='hs-layout'>,</span> <span class='hs-varid'>hsRecFieldArg</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>arg</span><span class='hs-layout'>,</span>
<a name="line-75"></a>                    <span class='hs-varid'>hsRecPun</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pun</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-76"></a>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>f</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppUnless</span> <span class='hs-varid'>pun</span> <span class='hs-varop'>$</span> <span class='hs-varid'>equals</span> <span class='hs-varop'>&lt;+&gt;</span> <span class='hs-varid'>ppr</span> <span class='hs-varid'>arg</span><span class='hs-layout'>)</span>
</pre>\end{code}


%************************************************************************
%*                                                                      *
%*              Building patterns
%*                                                                      *
%************************************************************************

\begin{code}
<pre><a name="line-1"></a><a name="mkPrefixConPat"></a><span class='hs-definition'>mkPrefixConPat</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>DataCon</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>OutPat</span> <span class='hs-varid'>id</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>Type</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>OutPat</span> <span class='hs-varid'>id</span>
<a name="line-2"></a><span class='hs-comment'>-- Make a vanilla Prefix constructor pattern</span>
<a name="line-3"></a><span class='hs-definition'>mkPrefixConPat</span> <span class='hs-varid'>dc</span> <span class='hs-varid'>pats</span> <span class='hs-varid'>tys</span>
<a name="line-4"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>noLoc</span> <span class='hs-varop'>$</span> <span class='hs-conid'>ConPatOut</span> <span class='hs-layout'>{</span> <span class='hs-varid'>pat_con</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>noLoc</span> <span class='hs-layout'>(</span><span class='hs-conid'>RealDataCon</span> <span class='hs-varid'>dc</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>pat_tvs</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span><span class='hs-layout'>,</span> <span class='hs-varid'>pat_dicts</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>[]</span><span class='hs-layout'>,</span>
<a name="line-5"></a>                        <span class='hs-varid'>pat_binds</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emptyTcEvBinds</span><span class='hs-layout'>,</span> <span class='hs-varid'>pat_args</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>PrefixCon</span> <span class='hs-varid'>pats</span><span class='hs-layout'>,</span>
<a name="line-6"></a>                        <span class='hs-varid'>pat_arg_tys</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>tys</span><span class='hs-layout'>,</span> <span class='hs-varid'>pat_wrap</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>idHsWrapper</span> <span class='hs-layout'>}</span>
<a name="line-7"></a>
<a name="line-8"></a><a name="mkNilPat"></a><span class='hs-definition'>mkNilPat</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Type</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>OutPat</span> <span class='hs-varid'>id</span>
<a name="line-9"></a><span class='hs-definition'>mkNilPat</span> <span class='hs-varid'>ty</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkPrefixConPat</span> <span class='hs-varid'>nilDataCon</span> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>ty</span><span class='hs-keyglyph'>]</span>
<a name="line-10"></a>
<a name="line-11"></a><a name="mkCharLitPat"></a><span class='hs-definition'>mkCharLitPat</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Char</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>OutPat</span> <span class='hs-varid'>id</span>
<a name="line-12"></a><span class='hs-definition'>mkCharLitPat</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mkPrefixConPat</span> <span class='hs-varid'>charDataCon</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>noLoc</span> <span class='hs-varop'>$</span> <span class='hs-conid'>LitPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>HsCharPrim</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-conid'>[]</span>
</pre>\end{code}


%************************************************************************
%*                                                                      *
%* Predicates for checking things about pattern-lists in EquationInfo   *
%*                                                                      *
%************************************************************************

\subsection[Pat-list-predicates]{Look for interesting things in patterns}

Unlike in the Wadler chapter, where patterns are either ``variables''
or ``constructors,'' here we distinguish between:
\begin{description}
\item[unfailable:]
Patterns that cannot fail to match: variables, wildcards, and lazy
patterns.

These are the irrefutable patterns; the two other categories
are refutable patterns.

\item[constructor:]
A non-literal constructor pattern (see next category).

\item[literal patterns:]
At least the numeric ones may be overloaded.
\end{description}

A pattern is in {\em exactly one} of the above three categories; `as'
patterns are treated specially, of course.

The 1.3 report defines what ``irrefutable'' and ``failure-free'' patterns are.
\begin{code}
<pre><a name="line-1"></a><a name="isStrictLPat"></a><span class='hs-definition'>isStrictLPat</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-2"></a><span class='hs-definition'>isStrictLPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>ParPat</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>             <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isStrictLPat</span> <span class='hs-varid'>p</span>
<a name="line-3"></a><span class='hs-definition'>isStrictLPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>BangPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>           <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-4"></a><span class='hs-definition'>isStrictLPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>TuplePat</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>Unboxed</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-5"></a><span class='hs-definition'>isStrictLPat</span> <span class='hs-keyword'>_</span>                            <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-6"></a>
<a name="line-7"></a><a name="isStrictHsBind"></a><span class='hs-definition'>isStrictHsBind</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsBind</span> <span class='hs-varid'>id</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-8"></a><span class='hs-comment'>-- A pattern binding with an outermost bang or unboxed tuple must be matched strictly</span>
<a name="line-9"></a><span class='hs-comment'>-- Defined in this module because HsPat is above HsBinds in the import graph</span>
<a name="line-10"></a><span class='hs-definition'>isStrictHsBind</span> <span class='hs-layout'>(</span><span class='hs-conid'>PatBind</span> <span class='hs-layout'>{</span> <span class='hs-varid'>pat_lhs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>isStrictLPat</span> <span class='hs-varid'>p</span>
<a name="line-11"></a><span class='hs-definition'>isStrictHsBind</span> <span class='hs-keyword'>_</span>                         <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-12"></a>
<a name="line-13"></a><a name="looksLazyPatBind"></a><span class='hs-definition'>looksLazyPatBind</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsBind</span> <span class='hs-varid'>id</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-14"></a><span class='hs-comment'>-- Returns True of anything *except*</span>
<a name="line-15"></a><span class='hs-comment'>--     a StrictHsBind (as above) or </span>
<a name="line-16"></a><span class='hs-comment'>--     a VarPat</span>
<a name="line-17"></a><span class='hs-comment'>-- In particular, returns True of a pattern binding with a compound pattern, like (I# x)</span>
<a name="line-18"></a><span class='hs-definition'>looksLazyPatBind</span> <span class='hs-layout'>(</span><span class='hs-conid'>PatBind</span> <span class='hs-layout'>{</span> <span class='hs-varid'>pat_lhs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>p</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>looksLazyLPat</span> <span class='hs-varid'>p</span>
<a name="line-19"></a><span class='hs-definition'>looksLazyPatBind</span> <span class='hs-keyword'>_</span>                         <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-20"></a>
<a name="line-21"></a><a name="looksLazyLPat"></a><span class='hs-definition'>looksLazyLPat</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-22"></a><span class='hs-definition'>looksLazyLPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>ParPat</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>             <span class='hs-keyglyph'>=</span> <span class='hs-varid'>looksLazyLPat</span> <span class='hs-varid'>p</span>
<a name="line-23"></a><span class='hs-definition'>looksLazyLPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>AsPat</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>            <span class='hs-keyglyph'>=</span> <span class='hs-varid'>looksLazyLPat</span> <span class='hs-varid'>p</span>
<a name="line-24"></a><span class='hs-definition'>looksLazyLPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>BangPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>           <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-25"></a><span class='hs-definition'>looksLazyLPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>TuplePat</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>Unboxed</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-26"></a><span class='hs-definition'>looksLazyLPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>VarPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>            <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-27"></a><span class='hs-definition'>looksLazyLPat</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>WildPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>           <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-28"></a><span class='hs-definition'>looksLazyLPat</span> <span class='hs-keyword'>_</span>                            <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-29"></a>
<a name="line-30"></a><a name="isIrrefutableHsPat"></a><span class='hs-definition'>isIrrefutableHsPat</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>OutputableBndr</span> <span class='hs-varid'>id</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>LPat</span> <span class='hs-varid'>id</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-31"></a><span class='hs-comment'>-- (isIrrefutableHsPat p) is true if matching against p cannot fail,</span>
<a name="line-32"></a><span class='hs-comment'>-- in the sense of falling through to the next pattern.</span>
<a name="line-33"></a><span class='hs-comment'>--      (NB: this is not quite the same as the (silly) defn</span>
<a name="line-34"></a><span class='hs-comment'>--      in 3.17.2 of the Haskell 98 report.)</span>
<a name="line-35"></a><span class='hs-comment'>--</span>
<a name="line-36"></a><span class='hs-comment'>-- isIrrefutableHsPat returns False if it's in doubt; specifically</span>
<a name="line-37"></a><span class='hs-comment'>-- on a ConPatIn it doesn't know the size of the constructor family</span>
<a name="line-38"></a><span class='hs-comment'>-- But if it returns True, the pattern is definitely irrefutable</span>
<a name="line-39"></a><span class='hs-definition'>isIrrefutableHsPat</span> <span class='hs-varid'>pat</span>
<a name="line-40"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>pat</span>
<a name="line-41"></a>  <span class='hs-keyword'>where</span>
<a name="line-42"></a>    <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pat</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go1</span> <span class='hs-varid'>pat</span>
<a name="line-43"></a>
<a name="line-44"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>WildPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-45"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>VarPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-46"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>LazyPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-47"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>BangPat</span> <span class='hs-varid'>pat</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>pat</span>
<a name="line-48"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>CoPat</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pat</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go1</span> <span class='hs-varid'>pat</span>
<a name="line-49"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>ParPat</span> <span class='hs-varid'>pat</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>pat</span>
<a name="line-50"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>AsPat</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pat</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>pat</span>
<a name="line-51"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>ViewPat</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>pat</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>pat</span>
<a name="line-52"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>SigPatIn</span> <span class='hs-varid'>pat</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>pat</span>
<a name="line-53"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>SigPatOut</span> <span class='hs-varid'>pat</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-varid'>go</span> <span class='hs-varid'>pat</span>
<a name="line-54"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>TuplePat</span> <span class='hs-varid'>pats</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>all</span> <span class='hs-varid'>go</span> <span class='hs-varid'>pats</span>
<a name="line-55"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>ListPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-56"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>PArrPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>     <span class='hs-comment'>-- ?</span>
<a name="line-57"></a>
<a name="line-58"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>ConPatIn</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>     <span class='hs-comment'>-- Conservative</span>
<a name="line-59"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>ConPatOut</span><span class='hs-layout'>{</span> <span class='hs-varid'>pat_con</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>RealDataCon</span> <span class='hs-varid'>con</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>pat_args</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>details</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-60"></a>        <span class='hs-keyglyph'>=</span>  <span class='hs-varid'>isJust</span> <span class='hs-layout'>(</span><span class='hs-varid'>tyConSingleDataCon_maybe</span> <span class='hs-layout'>(</span><span class='hs-varid'>dataConTyCon</span> <span class='hs-varid'>con</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-61"></a>           <span class='hs-comment'>-- NB: tyConSingleDataCon_maybe, *not* isProductTyCon, because</span>
<a name="line-62"></a>           <span class='hs-comment'>-- the latter is false of existentials. See Trac #4439</span>
<a name="line-63"></a>        <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>all</span> <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-varid'>hsConPatArgs</span> <span class='hs-varid'>details</span><span class='hs-layout'>)</span>
<a name="line-64"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>ConPatOut</span><span class='hs-layout'>{</span> <span class='hs-varid'>pat_con</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>L</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-conid'>PatSynCon</span> <span class='hs-sel'>_pat</span><span class='hs-layout'>)</span> <span class='hs-layout'>}</span><span class='hs-layout'>)</span>
<a name="line-65"></a>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span> <span class='hs-comment'>-- Conservative</span>
<a name="line-66"></a>
<a name="line-67"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>LitPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-68"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>NPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-69"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>NPlusKPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-70"></a>
<a name="line-71"></a>    <span class='hs-comment'>-- Both should be gotten rid of by renamer before</span>
<a name="line-72"></a>    <span class='hs-comment'>-- isIrrefutablePat is called</span>
<a name="line-73"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>SplicePat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>urk</span> <span class='hs-varid'>pat</span>    
<a name="line-74"></a>    <span class='hs-varid'>go1</span> <span class='hs-layout'>(</span><span class='hs-conid'>QuasiQuotePat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>urk</span> <span class='hs-varid'>pat</span>
<a name="line-75"></a>
<a name="line-76"></a>    <span class='hs-varid'>urk</span> <span class='hs-varid'>pat</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pprPanic</span> <span class='hs-str'>"isIrrefutableHsPat:"</span> <span class='hs-layout'>(</span><span class='hs-varid'>ppr</span> <span class='hs-varid'>pat</span><span class='hs-layout'>)</span>
<a name="line-77"></a>
<a name="line-78"></a><a name="hsPatNeedsParens"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pat</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-79"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>NPlusKPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-80"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>SplicePat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-81"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>QuasiQuotePat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-82"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>ConPatIn</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>ds</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>conPatNeedsParens</span> <span class='hs-varid'>ds</span>
<a name="line-83"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-varid'>p</span><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>ConPatOut</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>conPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-varid'>pat_args</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span>
<a name="line-84"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>SigPatIn</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-85"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>SigPatOut</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-86"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>ViewPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-87"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>CoPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-88"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>WildPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-89"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>VarPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-90"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>LazyPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-91"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>BangPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-92"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>ParPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-93"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>AsPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>          <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-94"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>TuplePat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-95"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>ListPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-96"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>PArrPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>        <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-97"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>LitPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>         <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-98"></a><span class='hs-definition'>hsPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>NPat</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>           <span class='hs-keyglyph'>=</span> <span class='hs-conid'>False</span>
<a name="line-99"></a>
<a name="line-100"></a><a name="conPatNeedsParens"></a><span class='hs-definition'>conPatNeedsParens</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HsConDetails</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<a name="line-101"></a><span class='hs-definition'>conPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>PrefixCon</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>not</span> <span class='hs-layout'>(</span><span class='hs-varid'>null</span> <span class='hs-varid'>args</span><span class='hs-layout'>)</span>
<a name="line-102"></a><span class='hs-definition'>conPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>InfixCon</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
<a name="line-103"></a><span class='hs-definition'>conPatNeedsParens</span> <span class='hs-layout'>(</span><span class='hs-conid'>RecCon</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>True</span>
</pre>\end{code}
</body>
</html>
