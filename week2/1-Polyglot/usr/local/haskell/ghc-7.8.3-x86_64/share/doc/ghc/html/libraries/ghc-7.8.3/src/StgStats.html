<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>simplStg/StgStats.lhs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
%
% (c) The GRASP/AQUA Project, Glasgow University, 1992-1998
%
\section[StgStats]{Gathers statistical information about programs}


The program gather statistics about
\begin{enumerate}
\item number of boxed cases
\item number of unboxed cases
\item number of let-no-escapes
\item number of non-updatable lets
\item number of updatable lets
\item number of applications
\item number of primitive applications
\item number of closures (does not include lets bound to constructors)
\item number of free variables in closures
%\item number of top-level functions
%\item number of top-level CAFs
\item number of constructors
\end{enumerate}

\begin{code}
<pre><a name="line-1"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>StgStats</span> <span class='hs-layout'>(</span> <span class='hs-varid'>showStgStats</span> <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-2"></a>
<a name="line-3"></a><span class='hs-cpp'>#include "HsVersions.h"</span>
<a name="line-4"></a>
<a name="line-5"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>StgSyn</span>
<a name="line-6"></a>
<a name="line-7"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Id</span> <span class='hs-layout'>(</span><span class='hs-conid'>Id</span><span class='hs-layout'>)</span>
<a name="line-8"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Panic</span>
<a name="line-9"></a>
<a name="line-10"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span><span class='hs-layout'>)</span>
<a name="line-11"></a><span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Map</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Map</span>
</pre>\end{code}

\begin{code}
<pre><a name="line-1"></a><a name="CounterType"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>CounterType</span>
<a name="line-2"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Literals</span>
<a name="line-3"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Applications</span>
<a name="line-4"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConstructorApps</span>
<a name="line-5"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>PrimitiveApps</span>
<a name="line-6"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>LetNoEscapes</span>
<a name="line-7"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>StgCases</span>
<a name="line-8"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>FreeVariables</span>
<a name="line-9"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ConstructorBinds</span> <span class='hs-conid'>Bool</span><span class='hs-comment'>{-True&lt;=&gt;top-level-}</span>
<a name="line-10"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ReEntrantBinds</span>   <span class='hs-conid'>Bool</span><span class='hs-comment'>{-ditto-}</span>
<a name="line-11"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>SingleEntryBinds</span> <span class='hs-conid'>Bool</span><span class='hs-comment'>{-ditto-}</span>
<a name="line-12"></a>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UpdatableBinds</span>   <span class='hs-conid'>Bool</span><span class='hs-comment'>{-ditto-}</span>
<a name="line-13"></a>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>Ord</span><span class='hs-layout'>)</span>
<a name="line-14"></a>
<a name="line-15"></a><a name="Count"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>Count</span>      <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Int</span>
<a name="line-16"></a><a name="StatEnv"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>StatEnv</span>    <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Map</span> <span class='hs-conid'>CounterType</span> <span class='hs-conid'>Count</span>
</pre>\end{code}

\begin{code}
<pre><a name="line-1"></a><a name="emptySE"></a><span class='hs-definition'>emptySE</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StatEnv</span>
<a name="line-2"></a><span class='hs-definition'>emptySE</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>empty</span>
<a name="line-3"></a>
<a name="line-4"></a><a name="combineSE"></a><span class='hs-definition'>combineSE</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StatEnv</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>StatEnv</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>StatEnv</span>
<a name="line-5"></a><span class='hs-definition'>combineSE</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>unionWith</span> <span class='hs-layout'>(</span><span class='hs-varop'>+</span><span class='hs-layout'>)</span>
<a name="line-6"></a>
<a name="line-7"></a><a name="combineSEs"></a><span class='hs-definition'>combineSEs</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>StatEnv</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>StatEnv</span>
<a name="line-8"></a><span class='hs-definition'>combineSEs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>foldr</span> <span class='hs-varid'>combineSE</span> <span class='hs-varid'>emptySE</span>
<a name="line-9"></a>
<a name="line-10"></a><a name="countOne"></a><span class='hs-definition'>countOne</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>CounterType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>StatEnv</span>
<a name="line-11"></a><span class='hs-definition'>countOne</span> <span class='hs-varid'>c</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>singleton</span> <span class='hs-varid'>c</span> <span class='hs-num'>1</span>
<a name="line-12"></a>
<a name="line-13"></a><a name="countN"></a><span class='hs-definition'>countN</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>CounterType</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>StatEnv</span>
<a name="line-14"></a><span class='hs-definition'>countN</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>singleton</span>
</pre>\end{code}

%************************************************************************
%*                                                                      *
\subsection{Top-level list of bindings (a ``program'')}
%*                                                                      *
%************************************************************************

\begin{code}
<pre><a name="line-1"></a><a name="showStgStats"></a><span class='hs-definition'>showStgStats</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>StgBinding</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>String</span>
<a name="line-2"></a>
<a name="line-3"></a><span class='hs-definition'>showStgStats</span> <span class='hs-varid'>prog</span>
<a name="line-4"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-str'>"STG Statistics:\n\n"</span>
<a name="line-5"></a>    <span class='hs-varop'>++</span> <span class='hs-varid'>concat</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>showc</span> <span class='hs-layout'>(</span><span class='hs-conid'>Map</span><span class='hs-varop'>.</span><span class='hs-varid'>toList</span> <span class='hs-layout'>(</span><span class='hs-varid'>gatherStgStats</span> <span class='hs-varid'>prog</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-6"></a>  <span class='hs-keyword'>where</span>
<a name="line-7"></a>    <span class='hs-varid'>showc</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span><span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>showString</span> <span class='hs-layout'>(</span><span class='hs-varid'>s</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varop'>.</span> <span class='hs-varid'>shows</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-str'>"\n"</span>
<a name="line-8"></a>
<a name="line-9"></a>    <span class='hs-varid'>s</span> <span class='hs-conid'>Literals</span>                <span class='hs-keyglyph'>=</span> <span class='hs-str'>"Literals                   "</span>
<a name="line-10"></a>    <span class='hs-varid'>s</span> <span class='hs-conid'>Applications</span>            <span class='hs-keyglyph'>=</span> <span class='hs-str'>"Applications               "</span>
<a name="line-11"></a>    <span class='hs-varid'>s</span> <span class='hs-conid'>ConstructorApps</span>         <span class='hs-keyglyph'>=</span> <span class='hs-str'>"ConstructorApps            "</span>
<a name="line-12"></a>    <span class='hs-varid'>s</span> <span class='hs-conid'>PrimitiveApps</span>           <span class='hs-keyglyph'>=</span> <span class='hs-str'>"PrimitiveApps              "</span>
<a name="line-13"></a>    <span class='hs-varid'>s</span> <span class='hs-conid'>LetNoEscapes</span>            <span class='hs-keyglyph'>=</span> <span class='hs-str'>"LetNoEscapes               "</span>
<a name="line-14"></a>    <span class='hs-varid'>s</span> <span class='hs-conid'>StgCases</span>                <span class='hs-keyglyph'>=</span> <span class='hs-str'>"StgCases                   "</span>
<a name="line-15"></a>    <span class='hs-varid'>s</span> <span class='hs-conid'>FreeVariables</span>           <span class='hs-keyglyph'>=</span> <span class='hs-str'>"FreeVariables              "</span>
<a name="line-16"></a>    <span class='hs-varid'>s</span> <span class='hs-layout'>(</span><span class='hs-conid'>ConstructorBinds</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-str'>"ConstructorBinds_Top       "</span>
<a name="line-17"></a>    <span class='hs-varid'>s</span> <span class='hs-layout'>(</span><span class='hs-conid'>ReEntrantBinds</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-str'>"ReEntrantBinds_Top         "</span>
<a name="line-18"></a>    <span class='hs-varid'>s</span> <span class='hs-layout'>(</span><span class='hs-conid'>SingleEntryBinds</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-str'>"SingleEntryBinds_Top       "</span>
<a name="line-19"></a>    <span class='hs-varid'>s</span> <span class='hs-layout'>(</span><span class='hs-conid'>UpdatableBinds</span> <span class='hs-conid'>True</span><span class='hs-layout'>)</span>   <span class='hs-keyglyph'>=</span> <span class='hs-str'>"UpdatableBinds_Top         "</span>
<a name="line-20"></a>    <span class='hs-varid'>s</span> <span class='hs-layout'>(</span><span class='hs-conid'>ConstructorBinds</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-str'>"ConstructorBinds_Nested    "</span>
<a name="line-21"></a>    <span class='hs-varid'>s</span> <span class='hs-layout'>(</span><span class='hs-conid'>ReEntrantBinds</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-str'>"ReEntrantBindsBinds_Nested "</span>
<a name="line-22"></a>    <span class='hs-varid'>s</span> <span class='hs-layout'>(</span><span class='hs-conid'>SingleEntryBinds</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <span class='hs-str'>"SingleEntryBinds_Nested    "</span>
<a name="line-23"></a>    <span class='hs-varid'>s</span> <span class='hs-layout'>(</span><span class='hs-conid'>UpdatableBinds</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>      <span class='hs-keyglyph'>=</span> <span class='hs-str'>"UpdatableBinds_Nested      "</span>
<a name="line-24"></a>
<a name="line-25"></a><a name="gatherStgStats"></a><span class='hs-definition'>gatherStgStats</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>StgBinding</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>StatEnv</span>
<a name="line-26"></a>
<a name="line-27"></a><span class='hs-definition'>gatherStgStats</span> <span class='hs-varid'>binds</span>
<a name="line-28"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>combineSEs</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>statBinding</span> <span class='hs-conid'>True</span><span class='hs-comment'>{-top-level-}</span><span class='hs-layout'>)</span> <span class='hs-varid'>binds</span><span class='hs-layout'>)</span>
</pre>\end{code}

%************************************************************************
%*                                                                      *
\subsection{Bindings}
%*                                                                      *
%************************************************************************

\begin{code}
<pre><a name="line-1"></a><a name="statBinding"></a><span class='hs-definition'>statBinding</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span> <span class='hs-comment'>-- True &lt;=&gt; top-level; False &lt;=&gt; nested</span>
<a name="line-2"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>StgBinding</span>
<a name="line-3"></a>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>StatEnv</span>
<a name="line-4"></a>
<a name="line-5"></a><span class='hs-definition'>statBinding</span> <span class='hs-varid'>top</span> <span class='hs-layout'>(</span><span class='hs-conid'>StgNonRec</span> <span class='hs-varid'>b</span> <span class='hs-varid'>rhs</span><span class='hs-layout'>)</span>
<a name="line-6"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>statRhs</span> <span class='hs-varid'>top</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-layout'>,</span> <span class='hs-varid'>rhs</span><span class='hs-layout'>)</span>
<a name="line-7"></a>
<a name="line-8"></a><span class='hs-definition'>statBinding</span> <span class='hs-varid'>top</span> <span class='hs-layout'>(</span><span class='hs-conid'>StgRec</span> <span class='hs-varid'>pairs</span><span class='hs-layout'>)</span>
<a name="line-9"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>combineSEs</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-layout'>(</span><span class='hs-varid'>statRhs</span> <span class='hs-varid'>top</span><span class='hs-layout'>)</span> <span class='hs-varid'>pairs</span><span class='hs-layout'>)</span>
<a name="line-10"></a>
<a name="line-11"></a><a name="statRhs"></a><span class='hs-definition'>statRhs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Id</span><span class='hs-layout'>,</span> <span class='hs-conid'>StgRhs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>StatEnv</span>
<a name="line-12"></a>
<a name="line-13"></a><span class='hs-definition'>statRhs</span> <span class='hs-varid'>top</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-conid'>StgRhsCon</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>
<a name="line-14"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>countOne</span> <span class='hs-layout'>(</span><span class='hs-conid'>ConstructorBinds</span> <span class='hs-varid'>top</span><span class='hs-layout'>)</span>
<a name="line-15"></a>
<a name="line-16"></a><span class='hs-definition'>statRhs</span> <span class='hs-varid'>top</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-conid'>StgRhsClosure</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>fv</span> <span class='hs-varid'>u</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span>
<a name="line-17"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>statExpr</span> <span class='hs-varid'>body</span>                       <span class='hs-varop'>`combineSE`</span>
<a name="line-18"></a>    <span class='hs-varid'>countN</span> <span class='hs-conid'>FreeVariables</span> <span class='hs-layout'>(</span><span class='hs-varid'>length</span> <span class='hs-varid'>fv</span><span class='hs-layout'>)</span>    <span class='hs-varop'>`combineSE`</span>
<a name="line-19"></a>    <span class='hs-varid'>countOne</span> <span class='hs-layout'>(</span>
<a name="line-20"></a>      <span class='hs-keyword'>case</span> <span class='hs-varid'>u</span> <span class='hs-keyword'>of</span>
<a name="line-21"></a>        <span class='hs-conid'>ReEntrant</span>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ReEntrantBinds</span>   <span class='hs-varid'>top</span>
<a name="line-22"></a>        <span class='hs-conid'>Updatable</span>   <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>UpdatableBinds</span>   <span class='hs-varid'>top</span>
<a name="line-23"></a>        <span class='hs-conid'>SingleEntry</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SingleEntryBinds</span> <span class='hs-varid'>top</span>
<a name="line-24"></a>    <span class='hs-layout'>)</span>
</pre>\end{code}

%************************************************************************
%*                                                                      *
\subsection{Expressions}
%*                                                                      *
%************************************************************************

\begin{code}
<pre><a name="line-1"></a><a name="statExpr"></a><span class='hs-definition'>statExpr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>StgExpr</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>StatEnv</span>
<a name="line-2"></a>
<a name="line-3"></a><span class='hs-definition'>statExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>StgApp</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>countOne</span> <span class='hs-conid'>Applications</span>
<a name="line-4"></a><span class='hs-definition'>statExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>StgLit</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <span class='hs-varid'>countOne</span> <span class='hs-conid'>Literals</span>
<a name="line-5"></a><span class='hs-definition'>statExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>StgConApp</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>countOne</span> <span class='hs-conid'>ConstructorApps</span>
<a name="line-6"></a><span class='hs-definition'>statExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>StgOpApp</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>countOne</span> <span class='hs-conid'>PrimitiveApps</span>
<a name="line-7"></a><span class='hs-definition'>statExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>StgSCC</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>statExpr</span> <span class='hs-varid'>e</span>
<a name="line-8"></a><span class='hs-definition'>statExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>StgTick</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>statExpr</span> <span class='hs-varid'>e</span>
<a name="line-9"></a>
<a name="line-10"></a><span class='hs-definition'>statExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>StgLetNoEscape</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>binds</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span>
<a name="line-11"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>statBinding</span> <span class='hs-conid'>False</span><span class='hs-comment'>{-not top-level-}</span> <span class='hs-varid'>binds</span>    <span class='hs-varop'>`combineSE`</span>
<a name="line-12"></a>    <span class='hs-varid'>statExpr</span> <span class='hs-varid'>body</span>                               <span class='hs-varop'>`combineSE`</span>
<a name="line-13"></a>    <span class='hs-varid'>countOne</span> <span class='hs-conid'>LetNoEscapes</span>
<a name="line-14"></a>
<a name="line-15"></a><span class='hs-definition'>statExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>StgLet</span> <span class='hs-varid'>binds</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span>
<a name="line-16"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>statBinding</span> <span class='hs-conid'>False</span><span class='hs-comment'>{-not top-level-}</span> <span class='hs-varid'>binds</span>    <span class='hs-varop'>`combineSE`</span>
<a name="line-17"></a>    <span class='hs-varid'>statExpr</span> <span class='hs-varid'>body</span>
<a name="line-18"></a>
<a name="line-19"></a><span class='hs-definition'>statExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>StgCase</span> <span class='hs-varid'>expr</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>alts</span><span class='hs-layout'>)</span>
<a name="line-20"></a>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>statExpr</span> <span class='hs-varid'>expr</span>       <span class='hs-varop'>`combineSE`</span>
<a name="line-21"></a>    <span class='hs-varid'>stat_alts</span> <span class='hs-varid'>alts</span>      <span class='hs-varop'>`combineSE`</span>
<a name="line-22"></a>    <span class='hs-varid'>countOne</span> <span class='hs-conid'>StgCases</span>
<a name="line-23"></a>  <span class='hs-keyword'>where</span>
<a name="line-24"></a>    <span class='hs-varid'>stat_alts</span> <span class='hs-varid'>alts</span>
<a name="line-25"></a>        <span class='hs-keyglyph'>=</span> <span class='hs-varid'>combineSEs</span> <span class='hs-layout'>(</span><span class='hs-varid'>map</span> <span class='hs-varid'>statExpr</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>e</span> <span class='hs-keyglyph'>|</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span><span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>alts</span> <span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-26"></a>
<a name="line-27"></a><span class='hs-definition'>statExpr</span> <span class='hs-layout'>(</span><span class='hs-conid'>StgLam</span> <span class='hs-layout'>{</span><span class='hs-layout'>}</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>panic</span> <span class='hs-str'>"statExpr StgLam"</span>
</pre>\end{code}

</body>
</html>
